# 网络基础知识

OSI七层网络协议

![](D:\0_LeargingSummary\网络协议\images\七层网络协议示意图.png)

TCP/IP五层模型

![](D:\0_LeargingSummary\网络协议\images\实际应用图.png)

应用层可以出现的协议：http协议、ssh协议

表示层可以出现的协议：Telnet、SNMP

会话层可以出现的协议：SMTP、DNS

传输控制层出现的协议：tcp协议，udp协议，在这一层发生三次握手，四次挥手

网络层找到目标ip的下一跳地址,路由判定，按位与

`route -n`查看路由表

![](D:\0_LeargingSummary\网络协议\images\路由表.png)

链路层最终会封装一个包，里面包含了三个地址，最外层是下一跳的MAC地址，第二层是最终目标的ip地址，第三层是端口号，到达的那个服务器的对应的进程

`arp -an`arp用来解析ip和网卡硬件地址的映射（DNS解析了域名和ip地址的映射）

![](D:\0_LeargingSummary\网络协议\images\路由表.png)

`netstat -natp`查看进程信息

# LVS负载均衡

![](D:\0_LeargingSummary\网络协议\images\四层负载均衡.png)

LVS不进行三次握手，直接将请求进行转发

# 网络问题

**http和https区别**

数据加密传输，是HTTP和HTTPS之间的本质性区别

`http特点：`

- 无连接：HTTP/1.1之前，由于无状态特点，每次请求需要通过TCP三次握手四次挥手，和服务器重新建立连接。比如某个客户机在短时间多次请求同一个资源，服务器并不能区别是否已经响应过用户的请求，所以每次需要重新响应请求，需要耗费不必要的时间和流量。
- 基于请求和响应：基本的特性，由客户端发起请求，服务端响应
- 通信使用明文、请求和响应不会对通信方进行确认、无法保护数据的完整性
  

`https特点`

- 基于HTTP协议，通过SSL或TLS提供加密处理数据、验证对方身份以及数据完整性保护

**http1.1和http1.0区别**

HTTP 1.1支持长连接（PersistentConnection）和请求的流水线（Pipelining）处理，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟，在HTTP1.1中默认开启Connection： keep-alive，一定程度上弥补了HTTP1.0每次请求都要创建连接的缺点。

**http协议基于tcp协议**

http是应用层协议，tcp是传输层协议；Socket是从传输层上抽象出来的，采用IP地址加端口号的形式来标识，并不是传统意义上的网络协议。

HTTP协议是基于TCP协议的，客户端向服务端发送一个HTTP请求时，需要先与服务端建立TCP连接，也就是经典的三次握手，握手成功以后才能进行数据交互。

HTTP是基于**请求响应模式且无状态**的协议，1.1之前只支持短连接，也就是请求响应一次以后连接中断，下次请求需要重新进行TCP连接，而1.1之后支持持长连接，即进行一次TCP连接以后，客户端可以发送多次的HTTP请求给服务器端。

**三次握手时，第三次响应丢失怎么办**

当Client端收到Server的SYN+ACK应答后，客户端状态就会变成ESTABLISHED，并发送ACK包给Server;

如果此时ACK包在网络中丢失，Server端该TCP连接的状态为SYN_RECV，且依次等待3秒、6秒、12秒后重新发送SYN+ACK包，以便Client重新发送ACK包。如果重发指定次数后，仍然未收到ACK应答，那么一段时间后，Server自动关闭这个连接。

但是Client认为这个连接已经建立，如果Client端向Server写数据，Server端将以RST包(用于强制关闭tcp连接)响应，方能感知到Server的错误。（RST包用于强制关闭TCP链接）

